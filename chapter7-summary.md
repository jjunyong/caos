# Chapter 7: 보조기억장치 요약

## 7-1: 다양한 보조기억장치

### 하드 디스크
- **정의**: 자기적인 방식으로 데이터를 저장하는 보조기억장치
- **구성 요소**:
  - **플래터(Platter)**: 데이터가 실제로 저장되는 원판, 자기 물질로 덮여 있어 N극과 S극(0과 1) 저장
  - **스핀들(Spindle)**: 플래터를 회전시키는 장치, 회전 속도는 RPM으로 표현
  - **헤드(Head)**: 플래터 위에서 미세하게 뜬 상태로 데이터를 읽고 쓰는 부품
  - **디스크암(Disk Arm)**: 헤드를 움직이는 장치
  
- **데이터 저장 단위**:
  - **섹터(Sector)**: 하드 디스크의 가장 작은 전송 단위 (일반적으로 512 바이트)
  - **트랙(Track)**: 동심원 형태로 구성된 데이터 저장 영역
  - **실린더(Cylinder)**: 여러 겹의 플래터에서 같은 위치의 트랙을 연결한 논리적 단위
    - 연속된 정보는 보통 한 실린더에 기록 (디스크 암을 움직이지 않고 접근 가능)

- **데이터 접근 시간**:
  - **탐색 시간(Seek Time)**: 접근하려는 데이터가 저장된 트랙까지 헤드를 이동시키는 시간
  - **회전 지연(Rotational Latency)**: 헤드가 있는 곳으로 플래터를 회전시키는 시간
  - **전송 시간(Transfer Time)**: 하드 디스크와 컴퓨터 간에 데이터를 전송하는 시간
  
- **성능 향상 방법**:
  - RPM을 높여 회전 속도 증가
  - 참조 지역성을 활용하여 데이터를 가까운 위치에 배치

### 플래시 메모리
- **종류**: USB, SD카드, SSD 등
- **특징**: 전기적으로 데이터를 읽고 쓸 수 있는 저장 장치

- **데이터 저장 단위**:
  - **셀(Cell)**: 데이터를 저장하는 가장 작은 단위
    - **유형**: SLC(Single Level Cell), MLC(Multi Level Cell), TLC(Triple Level Cell)
    - TLC로 갈수록 수명 짧고, 읽기/쓰기 속도 느려지며, 용량 대비 가격은 낮아짐
    
    | 셀 유형 | 셀당 비트 | 수명 | 읽기/쓰기 속도 | 용량 대비 가격 |
    |---------|-----------|------|----------------|----------------|
    | SLC (Single Level Cell) | 1비트 | 가장 김 (10만회 이상) | 가장 빠름 | 가장 비쌈 |
    | MLC (Multi Level Cell) | 2비트 | 중간 (3~5만회) | 중간 | 중간 |
    | TLC (Triple Level Cell) | 3비트 | 가장 짧음 (1~3만회) | 가장 느림 | 가장 저렴함 |
  - **페이지(Page)**: 셀들이 모여 만들어진 단위
  - **블록(Block)**: 페이지가 모여 만들어진 단위
  - **플레인(Plane) → 다이(Die)**: 상위 구조

- **데이터 처리 특성**:
  - 읽기/쓰기: 페이지 단위로 수행
  - 삭제: 블록 단위로만 수행 가능

- **페이지 상태**:
  - **Free**: 아무것도 저장되지 않은 상태 (새 데이터 저장 가능)
  - **Valid**: 유효한 데이터가 저장된 상태 (덮어쓰기 불가능)
  - **Invalid**: 유효하지 않은 데이터가 저장된 상태

- **가비지 컬렉션**: 플래시 메모리의 Invalid 상태인 페이지를 정리하는 기능

- **페이지 상태 변화와 가비지 컬렉션 예시**:
  ```
  [예시: 4개의 페이지로 구성된 블록]
  
  초기 상태:
  ┌─────────┬─────────┬─────────┬─────────┐
  │ 페이지1  │ 페이지2  │ 페이지3  │ 페이지4  │
  │ (A)     │ (B)     │ (Free)  │ (Free)  │
  │ Valid   │ Valid   │ Free    │ Free    │
  └─────────┴─────────┴─────────┴─────────┘
  
  C 데이터 추가:
  ┌─────────┬─────────┬─────────┬─────────┐
  │ 페이지1  │ 페이지2  │ 페이지3  │ 페이지4  │
  │ (A)     │ (B)     │ (C)     │ (Free)  │
  │ Valid   │ Valid   │ Valid   │ Free    │
  └─────────┴─────────┴─────────┴─────────┘
  
  A를 A'로 수정 (덮어쓰기 불가능):
  ┌─────────┬─────────┬─────────┬─────────┐
  │ 페이지1  │ 페이지2  │ 페이지3  │ 페이지4  │
  │ (A)     │ (B)     │ (C)     │ (A')    │
  │ Invalid │ Valid   │ Valid   │ Valid   │
  └─────────┴─────────┴─────────┴─────────┘
  
  블록이 모두 차면 가비지 컬렉션 필요:
  - Invalid 상태인 페이지1의 데이터는 더 이상 필요 없음
  - 하지만 삭제는 블록 단위로만 가능하기 때문에 Valid 데이터(B,C,A')를 
    다른 블록으로 복사한 후에 현재 블록 전체를 삭제해야 함
  ```

  가비지 컬렉션이 필요한 시점:
  1. Free 페이지가 부족해질 때
  2. Invalid 페이지가 많아져 공간 효율이 떨어질 때
  3. 쓰기 성능이 저하될 때

## 7-2: RAID의 정의와 종류

### RAID 정의
- **RAID**: Redundant Array of Independent Disks
- 여러 개의 보조기억장치를 하나의 논리적 보조기억장치처럼 사용하는 기술
- 데이터의 안정성과 성능 향상을 위해 사용

### RAID 종류

#### RAID 0
- **특징**: 스트라이핑(Striping) 방식으로 데이터를 여러 디스크에 분산 저장
- **장점**: 단일 저장장치 대비 이론상 n배 빠른 속도
- **단점**: 하나의 디스크에 문제 발생 시 모든 데이터 손실 위험

```
[RAID 0 구조]
┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐
│ 디스크1  │ │ 디스크2  │ │ 디스크3  │ │ 디스크4  │
├─────────┤ ├─────────┤ ├─────────┤ ├─────────┤
│ 데이터1  │ │ 데이터2  │ │ 데이터3  │ │ 데이터4  │
├─────────┤ ├─────────┤ ├─────────┤ ├─────────┤
│ 데이터5  │ │ 데이터6  │ │ 데이터7  │ │ 데이터8  │
├─────────┤ ├─────────┤ ├─────────┤ ├─────────┤
│   ...   │ │   ...   │ │   ...   │ │   ...   │
└─────────┘ └─────────┘ └─────────┘ └─────────┘
    데이터가 순차적으로 모든 디스크에 분산 저장됨
```

#### RAID 1
- **특징**: 복사본(미러링)을 생성하는 방식
- **장점**: 데이터 안정성 높음, 복구 간편
- **단점**: 공간 효율이 낮음 (이론상 속도는 n/2)

```
[RAID 1 구조]
┌─────────┐ ┌─────────┐   ┌─────────┐ ┌─────────┐
│ 디스크1  │ │ 디스크2  │   │ 디스크3  │ │ 디스크4  │
├─────────┤ ├─────────┤   ├─────────┤ ├─────────┤
│ 데이터1  │ │ 데이터1  │   │ 데이터3  │ │ 데이터3  │
├─────────┤ ├─────────┤   ├─────────┤ ├─────────┤
│ 데이터2  │ │ 데이터2  │   │ 데이터4  │ │ 데이터4  │
├─────────┤ ├─────────┤   ├─────────┤ ├─────────┤
│   ...   │ │   ...   │   │   ...   │ │   ...   │
└─────────┘ └─────────┘   └─────────┘ └─────────┘
    미러링(복제)            미러링(복제)
```

#### RAID 4
- **특징**: 데이터 디스크와 별도로 패리티 정보를 저장하는 전용 디스크 사용
- **장점**: RAID 1보다 적은 디스크로 데이터 안전 보관 가능
- **단점**: 패리티 디스크에 병목 현상 발생

```
[RAID 4 구조]
┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐
│ 디스크1  │ │ 디스크2  │ │ 디스크3  │ │패리티   │
├─────────┤ ├─────────┤ ├─────────┤ ├─────────┤
│ 데이터1  │ │ 데이터2  │ │ 데이터3  │ │패리티1-3│
├─────────┤ ├─────────┤ ├─────────┤ ├─────────┤
│ 데이터4  │ │ 데이터5  │ │ 데이터6  │ │패리티4-6│
├─────────┤ ├─────────┤ ├─────────┤ ├─────────┤
│   ...   │ │   ...   │ │   ...   │ │   ...   │
└─────────┘ └─────────┘ └─────────┘ └─────────┘
                        패리티 디스크에 쓰기 집중(병목)
```

#### RAID 5
- **특징**: 패리티 정보를 모든 디스크에 분산 저장
- **장점**: RAID 4의 병목 현상 해소
- **단점**: RAID 0보다는 느린 속도

```
[RAID 5 구조]
┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐
│ 디스크1  │ │ 디스크2  │ │ 디스크3  │ │ 디스크4  │
├─────────┤ ├─────────┤ ├─────────┤ ├─────────┤
│ 데이터1  │ │ 데이터2  │ │ 데이터3  │ │패리티1-3│
├─────────┤ ├─────────┤ ├─────────┤ ├─────────┤
│ 데이터4  │ │ 데이터5  │ │패리티4-6│ │ 데이터6  │
├─────────┤ ├─────────┤ ├─────────┤ ├─────────┤
│ 데이터7  │ │패리티7-9│ │ 데이터8  │ │ 데이터9  │
├─────────┤ ├─────────┤ ├─────────┤ ├─────────┤
│패리티10-12│ │ 데이터10 │ │ 데이터11 │ │ 데이터12 │
├─────────┤ ├─────────┤ ├─────────┤ ├─────────┤
│   ...   │ │   ...   │ │   ...   │ │   ...   │
└─────────┘ └─────────┘ └─────────┘ └─────────┘
          패리티 정보가 모든 디스크에 분산됨
```

#### RAID 6
- **특징**: 서로 다른 2개의 패리티 정보 사용
- **장점**: 데이터 안정성 극대화 (디스크 2개 동시 고장에도 데이터 보존)
- **단점**: 패리티 저장 공간이 RAID 5보다 2배 필요, 쓰기 속도 느림

```
[RAID 6 구조]
┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐
│ 디스크1  │ │ 디스크2  │ │ 디스크3  │ │ 디스크4  │ │ 디스크5  │
├─────────┤ ├─────────┤ ├─────────┤ ├─────────┤ ├─────────┤
│ 데이터1  │ │ 데이터2  │ │ 데이터3  │ │패리티1-3A│ │패리티1-3B│
├─────────┤ ├─────────┤ ├─────────┤ ├─────────┤ ├─────────┤
│ 데이터4  │ │ 데이터5  │ │패리티4-6A│ │패리티4-6B│ │ 데이터6  │
├─────────┤ ├─────────┤ ├─────────┤ ├─────────┤ ├─────────┤
│   ...   │ │   ...   │ │   ...   │ │   ...   │ │   ...   │
└─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘
             서로 다른 2개의 패리티 정보 사용
```

### RAID 선택 기준
각 RAID 방식마다 장단점이 있으므로, 상황과 우선순위(속도, 안정성, 공간 효율성)에 따라 최적의 RAID 구성이 달라짐
